{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Daily Worklog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Reuse your project’s main CSS -->
    <link rel="stylesheet" href="{% static 'css/main.css' %}" />

    <style>
      /* Any small tweaks that only apply to the daily worklog page */
      .daily-container {
        display: flex;
        flex-wrap: nowrap;
        gap: 1rem;
        margin: 1.5rem;
        height: calc(100vh - 3rem); /* fill most of the screen */
      }
      .daily-list {
        flex: 1 1 300px;
        border: 1px solid rgba(160,143,246,0.3);
        border-radius: 8px;
        overflow-y: auto;
        background: #fff;
      }
      .daily-list h2 {
        margin: 0;
        padding: 0.75rem 1rem;
        background: var(--purple-light);
        color: #281362;
        font-size: 1.25rem;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
      }
      .daily-list ul {
        list-style: none;
        padding: 0;
        margin: 0;
      }
      .daily-list li {
        padding: 0.75rem 1rem;
        border-bottom: 1px solid rgba(160,143,246,0.25);
        cursor: pointer;
        transition: background 0.2s;
      }
      .daily-list li:hover {
        background: rgba(192,184,250,0.1);
      }
      .daily-list li.selected {
        background: rgba(160,143,246,0.2);
      }

      .daily-detail {
        flex: 2 1 600px;
        border: 1px solid rgba(160,143,246,0.3);
        border-radius: 8px;
        background: #fff;
        display: flex;
        flex-direction: column;
      }
      .daily-detail h2 {
        margin: 0;
        padding: 0.75rem 1rem;
        background: var(--purple-light);
        color: #281362;
        font-size: 1.25rem;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
      }
      .daily-detail .detail-content {
        padding: 1rem;
        overflow-y: auto;
        flex: 1;
      }
      .daily-detail .empty-msg {
        color: #666;
        font-style: italic;
      }

      .detail-row {
        margin-bottom: 0.75rem;
      }
      .detail-label {
        font-weight: 600;
        color: var(--text-dark);
      }
      .detail-value {
        margin-left: 0.5rem;
      }
    </style>
</head>
<body>
    <!-- You can wrap in your existing header if needed -->
    <div class="hero-section">
      <div class="hero-content">
        <h1 class="hero-title">Daily Worklog</h1>
        <div class="hero-subtitle">
          {{ today|date:"F j, Y" }}
        </div>
      </div>
      <div class="geometric-shape"></div>
    </div>

    <div class="daily-container">
      {# Left column: list of today’s worklogs #}
      <div class="daily-list">
        <h2>Entries for {{ today|date:"M j, Y" }}</h2>
        {% if worklogs %}
          <ul id="worklog-list">
            {% for entry in worklogs %}
              <li 
                data-employee="{{ entry.employee.first_name }} {{ entry.employee.last_name }}"
                data-project="{{ entry.task.project.project_name }}"
                data-task="{{ entry.task.task_name }}"
                data-hours="{{ entry.hours_logged }}"
                data-date="{{ entry.date_worked }}"
                data-overtime="{{ entry.is_overtime }}"
                data-comments="{{ entry.comments|default_if_none:'' }}"
              >
                {{ entry.employee.first_name }} {{ entry.employee.last_name }} —
                {{ entry.task.task_name }} ({{ entry.hours_logged }}h)
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <div style="padding: 1rem; color: #666; font-style: italic;">
            No worklogs have been submitted for today.
          </div>
        {% endif %}
      </div>

      {# Right column: detail inspector #}
      <div class="daily-detail">
        <h2>Details</h2>
        <div class="detail-content" id="detail-content">
          <div class="empty-msg">Select a worklog on the left to view its details.</div>
        </div>
      </div>
    </div>

    <script>
      // When you click on any <li> in #worklog-list, fill the #detail-content area.
      document.addEventListener('DOMContentLoaded', function() {
        const list = document.getElementById('worklog-list');
        const detail = document.getElementById('detail-content');

        if (!list) {
          // no items—nothing to wire up
          return;
        }

        list.querySelectorAll('li').forEach(function(li) {
          li.addEventListener('click', function() {
            // Remove “selected” from any previously clicked
            list.querySelectorAll('li.selected').forEach(el => el.classList.remove('selected'));
            li.classList.add('selected');

            // Read data‐ attributes
            const emp      = li.getAttribute('data-employee');
            const proj     = li.getAttribute('data-project');
            const task     = li.getAttribute('data-task');
            const hours    = li.getAttribute('data-hours');
            const date     = li.getAttribute('data-date');
            const overtime = li.getAttribute('data-overtime');
            const comments = li.getAttribute('data-comments');

            // Build HTML inside detail pane
            detail.innerHTML = `
              <div class="detail-row">
                <span class="detail-label">Employee:</span>
                <span class="detail-value">${ emp }</span>
              </div>
              <div class="detail-row">
                <span class="detail-label">Project:</span>
                <span class="detail-value">${ proj }</span>
              </div>
              <div class="detail-row">
                <span class="detail-label">Task:</span>
                <span class="detail-value">${ task }</span>
              </div>
              <div class="detail-row">
                <span class="detail-label">Hours:</span>
                <span class="detail-value">${ hours } hour(s)</span>
              </div>
              <div class="detail-row">
                <span class="detail-label">Overtime:</span>
                <span class="detail-value">${ overtime === 'True' ? 'Yes' : 'No' }</span>
              </div>
              <div class="detail-row">
                <span class="detail-label">Date:</span>
                <span class="detail-value">${ date }</span>
              </div>
              <div class="detail-row">
                <span class="detail-label">Comments:</span>
                <span class="detail-value">${ comments || '<em>(none)</em>' }</span>
              </div>
            `;
          });
        });
      });
    </script>
</body>
</html>
